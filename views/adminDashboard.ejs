<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-900 text-white">
    <nav class="bg-indigo-900 p-4">
        <div class="container mx-auto flex justify-between">
            <h1 class="text-white text-xl">Admin Dashboard</h1>
            <a href="/logout" class="text-gray-300 hover:text-yellow-400">Logout</a>
        </div>
    </nav>

    <div class="container mx-auto p-6">
        <h2 class="text-2xl mb-4 text-yellow-500">Users and Their Posts</h2>
        <table class="w-full text-left bg-gray-800 rounded-lg">
            <thead>
                <tr>
                    <th class="p-3 border-b border-gray-700">User Name</th>
                    <th class="p-3 border-b border-gray-700">Email</th>
                    <th class="p-3 border-b border-gray-700">Post Content</th>
                    <th class="p-3 border-b border-gray-700">Post Date</th>
                    <th class="p-3 border-b border-gray-700">Likes</th>
                </tr>
            </thead>
            <tbody>
                <% if (users && users.length > 0) { %> <!-- Check if users exist -->
                    <% users.forEach(user => { %> <!-- Loop through each user -->
                        <% if (user.posts && user.posts.length > 0) { %> <!-- Check if user has posts -->
                            <% user.posts.forEach(post => { %> <!-- Loop through each post -->
                                <tr class="hover:bg-gray-700">
                                    <td class="p-3 border-b border-gray-700"><%= user.name %></td>
                                    <td class="p-3 border-b border-gray-700"><%= user.email %></td>
                                    <td class="p-3 border-b border-gray-700"><%= post.content %></td>
                                    <td class="p-3 border-b border-gray-700"><%= new Date(post.date).toLocaleDateString() %></td>
                                    <td class="p-3 border-b border-gray-700"><%= post.Likes.length %></td>
                                </tr>
                            <% }) %>
                        <% } else { %> <!-- If no posts -->
                            <tr>
                                <td colspan="5" class="text-center p-3 border-b border-gray-700">No posts for <%= user.name %></td>
                            </tr>
                        <% } %>
                    <% }) %>
                <% } else { %> <!-- If no users -->
                    <tr>
                        <td colspan="5" class="text-center p-3">No users available</td>
                    </tr>
                <% } %>
            </tbody>
        </table>
    </div>
</body>

</html>
